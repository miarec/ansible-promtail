---
# promtail install variables
promtail_http_listen_port: 9080
promtail_grpc_listen_port: 0
promtail_config_dir: "/etc/promtail"
promtail_config_file: "promtail-config.yml"
promtail_env_file: "promtail-env"
promtail_bin_dir: "/usr/local/bin"
promtail_bin: "promtail"
promtail_local_storage_dir: "etc/promtail"

# promtail behavior vars, this defines how promtail interacts with Loki

# promtail batch settings,  promtail will
# Maximum amount of time to wait before sending a batch, even if that
# batch isn't full.
promtail_batchwait: "1s"
# Maximum batch size (in bytes) of logs to accumulate before sending
# the batch to Loki.
promtail_batchsize: 1048576


# Configures how to retry requests to Loki when a request
# fails.
# Default backoff schedule:
# 0.5s, 1s, 2s, 4s, 8s, 16s, 32s, 64s, 128s, 256s(4.267m)
# For a total time of 511.5s(8.5m) before logs are lost
# Initial backoff time between retries
promtail_backoff_min_period: "500ms"
# Maximum backoff time between retries
promtail_backoff_max_period: "5m"
# Maximum number of retries to do
promtail_backoff_max_retries: 10


# When true, enforces rate limiting on this instance of Promtail.
promtail_readline_rate_enabled: true

# The rate limit in log lines per second that this instance of Promtail may push to Loki.
promtail_readline_rate: 10000

# The cap in the quantity of burst lines that this instance of Promtail may push
# to Loki.
promtail_readline_burst: 10000

# When true, exceeding the rate limit causes this instance of Promtail to discard
# log lines, rather than sending them to Loki. When false, exceeding the rate limit
# causes this instance of Promtail to temporarily hold off on sending the log lines and retry later.
readline_rate_drop: false


# promtail config variables

loki_dns_host: "loki"
loki_dns_domain: "local.internal"
loki_url: "{{ loki_dns_host }}.{{ loki_dns_domain }}"

loki_http_listen_port: 3100
loki_grpc_port: 0
promtail_hostname: "promtail-client"
scrape_jobs: [
  {'job_name':'miarec_speech', 'path':'/var/log/miarec_speech/*'}]

aws_install: false
aws_region: us-west-2
